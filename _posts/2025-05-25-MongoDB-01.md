---
layout: post
title: "MongoDB"
description: 
date: 2025-05-25
categories: MongoDB
---


# 1. Why use MongoDB?

MongoDB can be applied for three high performance scenerio.

    - High performance (concurrency)
    - Huge storage
    - High availablity and scalability

# 2. Concrete scenrio

    - Social : User info and Geo info
    - Game : User points and equipment
    - Logistics : position update
    - IoT : Intelligent devices info and deivce log
    - Live streaming : Like click

# 3. Advantage and Disadvantage

    - 2000-3000 QPS
    - Data storage with TB and PB
    
    - Data with low value
    - No support transaction / join
    - Data requeirement changes rapidly

# 4. What is it ?

## 4.1 Data Structure

- String : BSON
- Number : 64bit double
    - Long : NumberLong("10000")
    - Int : NumberInt("1")

## 4.2 Concept Structure

MongoDB is NoSQL Database

| MySQL | MOngoDB |
| :---:| :---: |
| Database | Database |
| Table | Collection |
| Row | Document |
| join | json embed |
| pk | ObjectId |


# 5. How to use it

## 5.1 Basic Operation on Shell

### 5.1.1 For Database

```shell
# create a database if not exists
use db_name

# drop a database
db.dropDatabase()
```

### 5.1.2 For Collection

```shell
# create a collection and insert value
db.col_name.insert()

# drop a collection
db.col_name.drop()
```

### 5.1.3 For Document

```shell
# add document
db.col_name.insert()
db.inventory.insertMany(
    [
        { item: "journal", qty: 25, tags: ["blank", "red"], size: { h: 14, w: 21, uom: "cm" } },
        { item: "mat", qty: 85, tags: ["gray"], size: { h: 27.9, w: 35.5, uom: "cm" } },
        { item: "mousepad", qty: 25, tags: ["gel", "blue"], size: { h: 19, w: 22.85, uom: "cm" } }
    ]
)

# query documents by condition
db.col_name.find({_id: "1"})
db.inventory.find({qty: {$gt: 20}})
db.inventory.find({}, {_id:0})

# update document
db.col_name.updateOne(<filter>, <update>, <options>)

## update partly
db.inventory.updateOne(
   { item: "paper" },
   {
     $set: { "size.uom": "cm", status: "P" },
     $currentDate: { lastModified: true }
   }
)

## update ulterly
db.inventory.replaceOne(
   { item: "paper" },
   { item: "paper", instock: [ { warehouse: "A", qty: 60 }, { warehouse: "B", qty: 40 } ] }
)

# delete document
db.inventory.deleteOne({_id: "2"})
```

