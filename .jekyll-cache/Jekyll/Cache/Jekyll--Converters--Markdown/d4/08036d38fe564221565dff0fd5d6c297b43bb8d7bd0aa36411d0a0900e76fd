I"ú!<p>SpringMVCé…ç½®ä¸‰å¤§ä»¶ï¼šå¤„ç†å™¨æ˜ å°„å™¨ã€å¤„ç†å™¨é€‚é…å™¨ã€è§†å›¾è§£æå™¨</p>

<h2 id="first-demo">First Demo</h2>

<ul>
  <li>This demo illustrates the mechanism of SpringMVC in previous post.</li>
</ul>

<h3 id="11-add-maven-dependencies">1.1 add maven dependencies</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-webmvc<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>5.2.0.RELEASE<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>javax.servlet<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>servlet-api<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>2.5<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>javax.servlet.jsp<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>jsp-api<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>2.1<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>javax.servlet<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>jstl<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.2<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<h3 id="12-register-dispatcherservlet-in-webxml">1.2 register DispatcherServlet in web.xml</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--1.æ³¨å†ŒDispatcherServlet--&gt;</span>
<span class="nt">&lt;servlet&gt;</span>
   <span class="nt">&lt;servlet-name&gt;</span>springmvc<span class="nt">&lt;/servlet-name&gt;</span>
   <span class="nt">&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="nt">&lt;/servlet-class&gt;</span>
   <span class="c">&lt;!--å…³è”ä¸€ä¸ªspringmvcçš„é…ç½®æ–‡ä»¶:ã€servlet-nameã€‘-servlet.xml--&gt;</span>
   <span class="nt">&lt;init-param&gt;</span>
       <span class="nt">&lt;param-name&gt;</span>contextConfigLocation<span class="nt">&lt;/param-name&gt;</span>
       <span class="nt">&lt;param-value&gt;</span>classpath:springmvc-servlet.xml<span class="nt">&lt;/param-value&gt;</span>
   <span class="nt">&lt;/init-param&gt;</span>
   <span class="c">&lt;!--å¯åŠ¨çº§åˆ«-1--&gt;</span>
   <span class="nt">&lt;load-on-startup&gt;</span>1<span class="nt">&lt;/load-on-startup&gt;</span>
<span class="nt">&lt;/servlet&gt;</span>

<span class="c">&lt;!--/ åŒ¹é…æ‰€æœ‰çš„è¯·æ±‚ï¼›ï¼ˆä¸åŒ…æ‹¬.jspï¼‰--&gt;</span>
<span class="c">&lt;!--/* åŒ¹é…æ‰€æœ‰çš„è¯·æ±‚ï¼›ï¼ˆåŒ…æ‹¬.jspï¼‰--&gt;</span>
<span class="nt">&lt;servlet-mapping&gt;</span>
   <span class="nt">&lt;servlet-name&gt;</span>springmvc<span class="nt">&lt;/servlet-name&gt;</span>
   <span class="nt">&lt;url-pattern&gt;</span>/<span class="nt">&lt;/url-pattern&gt;</span>
<span class="nt">&lt;/servlet-mapping&gt;</span>
</code></pre></div></div>

<h3 id="13-write-dispatcherservlet-configs-in-spring-servletxml">1.3 Write DispatcherServlet configs in spring-servlet.xml</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--  1.æ·»åŠ  å¤„ç†æ˜ å°„å™¨  --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping"</span><span class="nt">/&gt;</span>

<span class="c">&lt;!--  2.æ·»åŠ  å¤„ç†å™¨é€‚é…å™¨  --&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter"</span><span class="nt">/&gt;</span>

<span class="c">&lt;!--  3.è§†å›¾è§£æå™¨:DispatcherServletç»™ä»–çš„ModelAndView--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span> <span class="na">id=</span><span class="s">"ViewResolver"</span><span class="nt">&gt;</span>
   <span class="c">&lt;!--å‰ç¼€--&gt;</span>
   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"prefix"</span> <span class="na">value=</span><span class="s">"/WEB-INF/jsp/"</span><span class="nt">/&gt;</span>
   <span class="c">&lt;!--åç¼€--&gt;</span>
   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"suffix"</span> <span class="na">value=</span><span class="s">".jsp"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="c">&lt;!--Register a Handler and the request path--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"/hello"</span> <span class="na">class=</span><span class="s">"com.HB.controller.HelloController"</span><span class="nt">/&gt;</span>
</code></pre></div></div>

<h3 id="14-write-the-controller">1.4 Write the Controller</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloController</span> <span class="kd">implements</span> <span class="nc">Controller</span> <span class="o">{</span>

   <span class="kd">public</span> <span class="nc">ModelAndView</span> <span class="nf">handleRequest</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">req</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">resp</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
       <span class="c1">//ModelAndView æ¨¡å‹å’Œè§†å›¾</span>
       <span class="nc">ModelAndView</span> <span class="n">mv</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ModelAndView</span><span class="o">();</span>

       <span class="c1">//å°è£…å¯¹è±¡ï¼Œæ”¾åœ¨ModelAndViewä¸­,å¯ä»¥åœ¨hello.jspä¸­å–å‡º${msg}</span>
       <span class="n">mv</span><span class="o">.</span><span class="na">addObject</span><span class="o">(</span><span class="s">"msg"</span><span class="o">,</span><span class="s">"HelloSpringMVC!"</span><span class="o">);</span>
       <span class="c1">//å°è£…è¦è·³è½¬çš„è§†å›¾ï¼Œæ”¾åœ¨ModelAndViewä¸­</span>
       <span class="n">mv</span><span class="o">.</span><span class="na">setViewName</span><span class="o">(</span><span class="s">"hello"</span><span class="o">);</span> <span class="c1">//: /WEB-INF/jsp/hello.jsp</span>
       <span class="k">return</span> <span class="n">mv</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="o">&lt;!--</span><span class="nc">Register</span> <span class="n">a</span> <span class="nc">Handler</span> <span class="n">and</span> <span class="n">the</span> <span class="n">request</span> <span class="n">path</span><span class="o">--&gt;</span>
<span class="o">&lt;</span><span class="n">bean</span> <span class="n">id</span><span class="o">=</span><span class="s">"/hello"</span> <span class="kd">class</span><span class="err">="</span><span class="nc">com</span><span class="o">.</span><span class="na">HB</span><span class="o">.</span><span class="na">controller</span><span class="o">.</span><span class="na">HelloController</span><span class="err">"</span><span class="o">/&gt;</span>
</code></pre></div></div>

<h2 id="note">Note</h2>

<ul>
  <li>1.å¦‚æœé‡åˆ°404é”™è¯¯â€œæ‰¾ä¸åˆ°jarèµ„æºâ€ï¼Œé‚£ä¹ˆå¯èƒ½æ˜¯ç½‘ç»œç”Ÿæˆçš„åŒ…ä¸­æ²¡æœ‰å¼•å…¥mavenä¸­çš„ä¾èµ–é¡¹<br />
  åœ¨artifaceä¸­æ·»åŠ ä¸€ä¸ªlibæ–‡ä»¶å¤¹å¹¶å°†mavenä¾èµ–å¯¼å…¥</li>
  <li>2.web.xmlçš„ç‰ˆæœ¬å¿…é¡»å¤§äº4.0(é€šå¸¸ä½¿ç”¨add framework å¯¼å…¥)</li>
  <li>3.ä¸ºäº†å®‰å…¨æ€§ï¼Œå†…éƒ¨èµ„æºä¸€èˆ¬æ”¾åœ¨/web/WEB-INFä¸‹ï¼Œè€Œå…¬å…±èµ„æºç›´æ¥æ”¾åœ¨webä¸‹</li>
  <li>4.notice the defference of / and /*
```xml
<!--/ åŒ¹é…æ‰€æœ‰çš„è¯·æ±‚ï¼›ï¼ˆä¸åŒ…æ‹¬.jspï¼‰-->
<!--/* åŒ¹é…æ‰€æœ‰çš„è¯·æ±‚ï¼›ï¼ˆåŒ…æ‹¬.jspï¼‰--></li>
</ul>
<servlet-mapping>
   <servlet-name>springmvc</servlet-name>
   <url-pattern>/</url-pattern>
```
</servlet-mapping>
:ET