# 第二章 InnoDB存储引擎

- InnoDB是事务安全、OLTP应用的存储引擎

## 2.1 概述

- 第一个支持ACID事务的MySQL存储引擎
- 行锁设计
- MVCC

## 2.2 InnoDB存储引擎架构

- 图：n个后台线程 ---> 存储引擎内存池 ---> 硬盘文件

### 2.2.1 后台线程

- 后台线程主要作用：更新内存池中的缓存数据（保证缓存最新的数据/将修改的数据刷新给磁盘文件）

- 多线程后台，不同线程处理不同任务

- 1. Master Thread (刷新数据到磁盘)
- 2. IO Thread (AIO处理IO请求的回调)  
write / read / insert buffer / log
  4      4         1            1  

- 3. Purge Thread (回收undo页)
- 4. Page Cleaner Thread (刷新脏页)

### 2.2.2 内存

1. 缓冲池

- InnoDB是基于磁盘存储的， 并将其中的记录按照_页_的方式进行过管理

- 为了弥补磁盘和CPU的计算速度，需要在内存中使用缓冲池

- 数据库进行读取时  
    首先将磁盘中的页存放在缓冲池中  
    在读到相同的页时从缓冲池中取  
- 对数据库中的页修改时  
    首先修改缓冲池中的页  
    然后再择机(checkpoint)刷新到磁盘上  
    具体如图所示

- 可以有多个缓冲池实例，缓存的页按照哈希值平均分配到不同缓冲池中


2. 缓存池管理方式

- LRU
40~